<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Query Parameter Checker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .parameter {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .parameter.found {
            border-color: #4CAF50;
            background-color: #e8f5e9;
        }
        .parameter.not-found {
            border-color: #f44336;
            background-color: #ffebee;
        }
        .param-name {
            font-weight: bold;
            font-size: 16px;
        }
        .param-value {
            font-family: monospace;
            color: #666;
            max-width: 300px;
            word-break: break-all;
        }
        .status {
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
        }
        .status.found {
            background-color: #4CAF50;
        }
        .status.not-found {
            background-color: #f44336;
        }
        .current-url {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            word-break: break-all;
        }
        .summary {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>URL Query Parameter Checker</h1>
        
        <div class="current-url">
            <strong>Current URL:</strong> <span id="currentUrl"></span>
        </div>
        
        <div id="results"></div>
        
        <div class="summary">
            <h3>Summary</h3>
            <p id="summaryText"></p>
        </div>
    </div>

    <script>
        // Parameters to check for - 'q' should be present, others should NOT be present
        const parametersToCheck = [
            { name: 'q', shouldBePresent: true },
            { name: 'fbclid', shouldBePresent: false },
            { name: 'fb_source', shouldBePresent: false },
            { name: 'utm_source', shouldBePresent: false },
            { name: 'utm_medium', shouldBePresent: false }
        ];
        
        // Get current URL and parse query parameters
        const currentUrl = window.location.href;
        const urlParams = new URLSearchParams(window.location.search);
        
        // Display current URL
        document.getElementById('currentUrl').textContent = currentUrl;
        
        // Check each parameter
        const results = parametersToCheck.map(param => {
            const value = urlParams.get(param.name);
            const found = value !== null;
            const isDesiredState = found === param.shouldBePresent;
            
            return {
                name: param.name,
                found: found,
                value: value,
                shouldBePresent: param.shouldBePresent,
                isDesiredState: isDesiredState
            };
        });
        
        // Display results
        const resultsContainer = document.getElementById('results');
        results.forEach(result => {
            const paramDiv = document.createElement('div');
            paramDiv.className = `parameter ${result.isDesiredState ? 'found' : 'not-found'}`;
            
            let statusText;
            let statusClass;
            
            if (result.shouldBePresent) {
                statusText = result.found ? 'Found ✓' : 'Missing ✗';
                statusClass = result.found ? 'found' : 'not-found';
            } else {
                statusText = result.found ? 'Present ✗' : 'Clean ✓';
                statusClass = result.found ? 'not-found' : 'found';
            }
            
            paramDiv.innerHTML = `
                <div class="param-name">${result.name} ${result.shouldBePresent ? '(required)' : '(should be absent)'}</div>
                <div class="param-value">${result.found ? result.value : 'Not present'}</div>
                <div class="status ${statusClass}">
                    ${statusText}
                </div>
            `;
            
            resultsContainer.appendChild(paramDiv);
        });
        
        // Generate summary
        const goodParams = results.filter(r => r.isDesiredState);
        const badParams = results.filter(r => !r.isDesiredState);
        const summaryText = document.getElementById('summaryText');
        
        // Find other parameters not in our check list
        const checkedParamNames = parametersToCheck.map(p => p.name);
        const otherParams = [];
        for (const [key, value] of urlParams.entries()) {
            if (!checkedParamNames.includes(key)) {
                otherParams.push({ name: key, value: value });
            }
        }
        
        let summaryHTML = '';
        
        if (badParams.length === 0) {
            summaryHTML = `<strong style="color: #4CAF50;">Perfect! ✓</strong><br>
                All parameters are in their desired state.`;
        } else {
            summaryHTML = `<strong style="color: #f44336;">Issues found:</strong><br>
                ${badParams.map(p => {
                    if (p.shouldBePresent && !p.found) {
                        return `Missing required parameter: ${p.name}`;
                    } else if (!p.shouldBePresent && p.found) {
                        return `Unwanted parameter present: ${p.name}`;
                    }
                }).join('<br>')}`;
        }
        
        // Add other parameters section
        if (otherParams.length > 0) {
            summaryHTML += `<br><br><strong>Other parameters found:</strong><br>
                ${otherParams.map(p => `${p.name} = ${p.value}`).join('<br>')}`;
        }
        
        summaryText.innerHTML = summaryHTML;
        
        // Log results to console for debugging
        console.log('URL Parameter Check Results:', results);
    </script>
</body>
</html>